commit 757de0d7cbe63bf17334e23075793d89492341ba
Author: Sopot Cela <scela@redhat.com>
Date:   Wed Mar 16 15:19:21 2016 +0100

    Guava and Lucene migration

diff --git a/bundles/org.eclipse.epp.logging.aeri.ide/src/org/eclipse/epp/internal/logging/aeri/ide/server/json/Json.java b/bundles/org.eclipse.epp.logging.aeri.ide/src/org/eclipse/epp/internal/logging/aeri/ide/server/json/Json.java
index 7ca739e..6768704 100644
--- a/bundles/org.eclipse.epp.logging.aeri.ide/src/org/eclipse/epp/internal/logging/aeri/ide/server/json/Json.java
+++ b/bundles/org.eclipse.epp.logging.aeri.ide/src/org/eclipse/epp/internal/logging/aeri/ide/server/json/Json.java
@@ -38,6 +38,7 @@ import com.google.common.collect.Lists;
 import com.google.common.io.Closeables;
 import com.google.common.io.Files;
 import com.google.common.io.InputSupplier;
+import com.google.common.io.ByteSource;
 import com.google.gson.Gson;
 import com.google.gson.GsonBuilder;
 import com.google.gson.TypeAdapter;
@@ -148,8 +149,8 @@ public class Json {
         List<T> res = Lists.newLinkedList();
         ZipInputStream zis = null;
         try {
-            InputSupplier<FileInputStream> fis = Files.newInputStreamSupplier(zip);
-            zis = new ZipInputStream(fis.getInput());
+            ByteSource fis = Files.asByteSource(zip);
+            zis = new ZipInputStream(fis.openStream());
             ZipEntry entry;
             while ((entry = zis.getNextEntry()) != null) {
                 if (!entry.isDirectory()) {
diff --git a/bundles/org.eclipse.epp.logging.aeri.ide/src/org/eclipse/epp/internal/logging/aeri/ide/utils/Zips.java b/bundles/org.eclipse.epp.logging.aeri.ide/src/org/eclipse/epp/internal/logging/aeri/ide/utils/Zips.java
index 729a880..5962382 100644
--- a/bundles/org.eclipse.epp.logging.aeri.ide/src/org/eclipse/epp/internal/logging/aeri/ide/utils/Zips.java
+++ b/bundles/org.eclipse.epp.logging.aeri.ide/src/org/eclipse/epp/internal/logging/aeri/ide/utils/Zips.java
@@ -25,6 +25,8 @@ import com.google.common.base.Throwables;
 import com.google.common.io.Closeables;
 import com.google.common.io.FileWriteMode;
 import com.google.common.io.Files;
+import com.google.common.io.ByteSource;
+import com.google.common.io.ByteSink;
 import com.google.common.io.OutputSupplier;
 
 public class Zips {
@@ -52,8 +54,8 @@ public class Zips {
     public static void zip(File directory, File out) throws IOException {
         ZipOutputStream zos = null;
         try {
-            OutputSupplier<FileOutputStream> s = Files.newOutputStreamSupplier(out);
-            zos = new ZipOutputStream(s.getOutput());
+            ByteSink s = Files.asByteSink(out);
+            zos = new ZipOutputStream(s.openStream());
             for (File f : FileUtils.listFiles(directory, FILE, DIRECTORY)) {
                 String path = removeStart(f.getPath(), directory.getAbsolutePath() + File.separator);
                 path = path.replace(File.separatorChar, '/');
